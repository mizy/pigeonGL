{"code":"!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=8)}([function(e,t,r){\"use strict\";r.r(t),function(e){!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}();var t=function(){function e(t){!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,e);for(var r in this._userConfig=t,t)this[r]=t[r]}return function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(e,[{key:\"on\",value:function(e,t){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}},{key:\"fire\",value:function(e,t){if(void 0!==this._listeners){var r=this._listeners[e];if(void 0!==r)for(var n=r.slice(0),i=0,a=n.length;i<a;i++)n[i].call(this,t)}}},{key:\"off\",value:function(e,t){if(void 0!==this._listeners){var r=this._listeners[e];if(void 0!==r)if(t){var n=r.indexOf(t);-1!==n&&r.splice(n,1)}else this._listeners[e]=[]}}},{key:\"initConfig\",value:function(e){}},{key:\"onAdd\",value:function(e){this.pigeonMap=e}},{key:\"update\",value:function(){}},{key:\"onRemove\",value:function(){this._listeners&&(this._listeners=[])}}]),e}();e.exports=t}.call(this,r(1)(e))},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,\"loaded\",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,\"id\",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,\"exports\",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t){var r=512*Math.pow(2,0);e.exports={WORLD_SIZE_RATIO:0,WORLD_SIZE:r,PROJECTION_WORLD_SIZE:r/(6378137*Math.PI)/2,MERCATOR_A:6378137,DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,EARTH_CIRCUMFERENCE:40075e3,DISTANCE:200}},function(e,t,r){\"use strict\";r.r(t),function(e){!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/typeof'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),e.exports.prettyPrintMatrix=function(e){for(var t=0;t<4;t++)e[t],e[t+4],e[t+8],e[t+12]},e.exports.makePerspectiveMatrix=function(e,t,r,n){var i=new THREE.Matrix4,a=1/Math.tan(e/2),o=1/(r-n);return i.elements[0]=a/t,i.elements[1]=0,i.elements[2]=0,i.elements[3]=0,i.elements[4]=0,i.elements[5]=a,i.elements[6]=0,i.elements[7]=0,i.elements[8]=0,i.elements[9]=0,i.elements[10]=(n+r)*o,i.elements[11]=-1,i.elements[12]=0,i.elements[13]=0,i.elements[14]=2*n*r*o,i.elements[15]=0,i},e.exports.radify=function(e){return\"object\"===!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/typeof'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(e)?e.map((function(e){return 2*Math.PI*e/360})):2*Math.PI*e/360},e.exports.degreeify=function(e){return 360*e/(2*Math.PI)}}.call(this,r(1)(e))},function(e,t){var r=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};r.prototype={constructor:r,load:function(e,t,r,n){var i=this,a=new THREE.FileLoader(this.manager);a.setPath(this.path),a.load(e,(function(e){t(i.parse(e))}),r,n)},setPath:function(e){this.path=e},setTexturePath:function(e){this.texturePath=e},setBaseUrl:function(e){console.warn(\"THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead.\"),this.setTexturePath(e)},setCrossOrigin:function(e){this.crossOrigin=e},setMaterialOptions:function(e){this.materialOptions=e},parse:function(e){for(var t=e.split(\"\\n\"),n={},i=/\\s+/,a={},o=0;o<t.length;o++){var s=t[o];if(0!==(s=s.trim()).length&&\"#\"!==s.charAt(0)){var l=s.indexOf(\" \"),h=l>=0?s.substring(0,l):s;h=h.toLowerCase();var c=l>=0?s.substring(l+1):\"\";if(c=c.trim(),\"newmtl\"===h)n={name:c},a[c]=n;else if(n)if(\"ka\"===h||\"kd\"===h||\"ks\"===h){var u=c.split(i,3);n[h]=[parseFloat(u[0]),parseFloat(u[1]),parseFloat(u[2])]}else n[h]=c}}var p=new r.MaterialCreator(this.texturePath||this.path,this.materialOptions);return p.setCrossOrigin(this.crossOrigin),p.setManager(this.manager),p.setMaterials(a),p}},(r.MaterialCreator=function(e,t){this.baseUrl=e||\"\",this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping}).prototype={constructor:r.MaterialCreator,setCrossOrigin:function(e){this.crossOrigin=e},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var r in e){var n=e[r],i={};for(var a in t[r]=i,n){var o=!0,s=n[a],l=a.toLowerCase();switch(l){case\"kd\":case\"ka\":case\"ks\":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(o=!1)}o&&(i[l]=s)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){var t=this,r=this.materialsInfo[e],n={name:e,side:this.side};function i(e,r){if(!n[e]){var i,a,o=t.getTextureParams(r,n),s=t.loadTexture((i=t.baseUrl,\"string\"!=typeof(a=o.url)||\"\"===a?\"\":/^https?:\\/\\//i.test(a)?a:i+a));s.repeat.copy(o.scale),s.offset.copy(o.offset),s.wrapS=t.wrap,s.wrapT=t.wrap,n[e]=s}}for(var a in r){var o=r[a];if(\"\"!==o)switch(a.toLowerCase()){case\"kd\":n.color=(new THREE.Color).fromArray(o);break;case\"ks\":n.specular=(new THREE.Color).fromArray(o);break;case\"map_kd\":i(\"map\",o);break;case\"map_ks\":i(\"specularMap\",o);break;case\"map_bump\":case\"bump\":i(\"bumpMap\",o);break;case\"ns\":n.shininess=parseFloat(o);break;case\"d\":o<1&&(n.opacity=o,n.transparent=!0);break;case\"Tr\":o>0&&(n.opacity=1-o,n.transparent=!0)}}return this.materials[e]=new THREE.MeshPhongMaterial(n),this.materials[e]},getTextureParams:function(e,t){var r,n={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},i=e.split(/\\s+/);return(r=i.indexOf(\"-bm\"))>=0&&(t.bumpScale=parseFloat(i[r+1]),i.splice(r,2)),(r=i.indexOf(\"-s\"))>=0&&(n.scale.set(parseFloat(i[r+1]),parseFloat(i[r+2])),i.splice(r,4)),(r=i.indexOf(\"-o\"))>=0&&(n.offset.set(parseFloat(i[r+1]),parseFloat(i[r+2])),i.splice(r,4)),n.url=i.join(\" \").trim(),n},loadTexture:function(e,t,r,n,i){var a,o=THREE.Loader.Handlers.get(e),s=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager;return null===o&&(o=new THREE.TextureLoader(s)),o.setCrossOrigin&&o.setCrossOrigin(this.crossOrigin),a=o.load(e,r,n,i),void 0!==t&&(a.mapping=t),a}},e.exports=r},function(e,t){var r=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.materials=null,this.regexp={vertex_pattern:/^v\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)/,normal_pattern:/^vn\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)/,uv_pattern:/^vt\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)/,face_vertex:/^f\\s+(-?\\d+)\\s+(-?\\d+)\\s+(-?\\d+)(?:\\s+(-?\\d+))?/,face_vertex_uv:/^f\\s+(-?\\d+)\\/(-?\\d+)\\s+(-?\\d+)\\/(-?\\d+)\\s+(-?\\d+)\\/(-?\\d+)(?:\\s+(-?\\d+)\\/(-?\\d+))?/,face_vertex_uv_normal:/^f\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+)\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+)\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+)(?:\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+))?/,face_vertex_normal:/^f\\s+(-?\\d+)\\/\\/(-?\\d+)\\s+(-?\\d+)\\/\\/(-?\\d+)\\s+(-?\\d+)\\/\\/(-?\\d+)(?:\\s+(-?\\d+)\\/\\/(-?\\d+))?/,object_pattern:/^[og]\\s*(.+)?/,smoothing_pattern:/^s\\s+(\\d+|on|off)/,material_library_pattern:/^mtllib /,material_use_pattern:/^usemtl /}};r.prototype={constructor:r,load:function(e,t,r,n){var i=this,a=new THREE.FileLoader(i.manager);a.setPath(this.path),a.load(e,(function(e){t(i.parse(e))}),r,n)},setPath:function(e){this.path=e},setMaterials:function(e){this.materials=e},_createParserState:function(){var e={objects:[],object:{},vertices:[],normals:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var r=this.object&&\"function\"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&\"function\"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||\"\",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(e,t){var r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);var n={index:this.materials.length,name:e||\"\",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:\"\",smooth:void 0!==r?r.smooth:this.smooth,groupStart:void 0!==r?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:\"number\"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(n),n},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&0===this.materials.length&&this.materials.push({name:\"\",smooth:this.smooth}),t}},r&&r.name&&\"function\"==typeof r.clone){var n=r.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&\"function\"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseNormalIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseUVIndex:function(e,t){var r=parseInt(e,10);return 2*(r>=0?r-1:r+t/2)},addVertex:function(e,t,r){var n=this.vertices,i=this.object.geometry.vertices;i.push(n[e+0]),i.push(n[e+1]),i.push(n[e+2]),i.push(n[t+0]),i.push(n[t+1]),i.push(n[t+2]),i.push(n[r+0]),i.push(n[r+1]),i.push(n[r+2])},addVertexLine:function(e){var t=this.vertices,r=this.object.geometry.vertices;r.push(t[e+0]),r.push(t[e+1]),r.push(t[e+2])},addNormal:function(e,t,r){var n=this.normals,i=this.object.geometry.normals;i.push(n[e+0]),i.push(n[e+1]),i.push(n[e+2]),i.push(n[t+0]),i.push(n[t+1]),i.push(n[t+2]),i.push(n[r+0]),i.push(n[r+1]),i.push(n[r+2])},addUV:function(e,t,r){var n=this.uvs,i=this.object.geometry.uvs;i.push(n[e+0]),i.push(n[e+1]),i.push(n[t+0]),i.push(n[t+1]),i.push(n[r+0]),i.push(n[r+1])},addUVLine:function(e){var t=this.uvs,r=this.object.geometry.uvs;r.push(t[e+0]),r.push(t[e+1])},addFace:function(e,t,r,n,i,a,o,s,l,h,c,u){var p,d=this.vertices.length,m=this.parseVertexIndex(e,d),f=this.parseVertexIndex(t,d),v=this.parseVertexIndex(r,d);if(void 0===n?this.addVertex(m,f,v):(p=this.parseVertexIndex(n,d),this.addVertex(m,f,p),this.addVertex(f,v,p)),void 0!==i){var E=this.uvs.length;m=this.parseUVIndex(i,E),f=this.parseUVIndex(a,E),v=this.parseUVIndex(o,E),void 0===n?this.addUV(m,f,v):(p=this.parseUVIndex(s,E),this.addUV(m,f,p),this.addUV(f,v,p))}if(void 0!==l){var w=this.normals.length;m=this.parseNormalIndex(l,w),f=l===h?m:this.parseNormalIndex(h,w),v=l===c?m:this.parseNormalIndex(c,w),void 0===n?this.addNormal(m,f,v):(p=this.parseNormalIndex(u,w),this.addNormal(m,f,p),this.addNormal(f,v,p))}},addLineGeometry:function(e,t){this.object.geometry.type=\"Line\";for(var r=this.vertices.length,n=this.uvs.length,i=0,a=e.length;i<a;i++)this.addVertexLine(this.parseVertexIndex(e[i],r));var o=0;for(a=t.length;o<a;o++)this.addUVLine(this.parseUVIndex(t[o],n))}};return e.startObject(\"\",!1),e},parse:function(e){var t=this._createParserState();-1!==e.indexOf(\"\\r\\n\")&&(e=e.replace(/\\r\\n/g,\"\\n\")),-1!==e.indexOf(\"\\\\\\n\")&&(e=e.replace(/\\\\\\n/g,\"\"));for(var r=e.split(\"\\n\"),n=\"\",i=\"\",a=\"\",o=[],s=\"function\"==typeof\"\".trimLeft,l=0,h=r.length;l<h;l++)if(n=r[l],0!==(n=s?n.trimLeft():n.trim()).length&&\"#\"!==(i=n.charAt(0)))if(\"v\"===i)if(\" \"===(a=n.charAt(1))&&null!==(o=this.regexp.vertex_pattern.exec(n)))t.vertices.push(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]));else if(\"n\"===a&&null!==(o=this.regexp.normal_pattern.exec(n)))t.normals.push(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]));else{if(\"t\"!==a||null===(o=this.regexp.uv_pattern.exec(n)))throw new Error(\"Unexpected vertex/normal/uv line: '\"+n+\"'\");t.uvs.push(parseFloat(o[1]),parseFloat(o[2]))}else if(\"f\"===i)if(null!==(o=this.regexp.face_vertex_uv_normal.exec(n)))t.addFace(o[1],o[4],o[7],o[10],o[2],o[5],o[8],o[11],o[3],o[6],o[9],o[12]);else if(null!==(o=this.regexp.face_vertex_uv.exec(n)))t.addFace(o[1],o[3],o[5],o[7],o[2],o[4],o[6],o[8]);else if(null!==(o=this.regexp.face_vertex_normal.exec(n)))t.addFace(o[1],o[3],o[5],o[7],void 0,void 0,void 0,void 0,o[2],o[4],o[6],o[8]);else{if(null===(o=this.regexp.face_vertex.exec(n)))throw new Error(\"Unexpected face line: '\"+n+\"'\");t.addFace(o[1],o[2],o[3],o[4])}else if(\"l\"===i){var c=n.substring(1).trim().split(\" \"),u=[],p=[];if(-1===n.indexOf(\"/\"))u=c;else for(var d=0,m=c.length;d<m;d++){var f=c[d].split(\"/\");\"\"!==f[0]&&u.push(f[0]),\"\"!==f[1]&&p.push(f[1])}t.addLineGeometry(u,p)}else if(null!==(o=this.regexp.object_pattern.exec(n))){var v=(\" \"+o[0].substr(1).trim()).substr(1);t.startObject(v)}else if(this.regexp.material_use_pattern.test(n))t.object.startMaterial(n.substring(7).trim(),t.materialLibraries);else if(this.regexp.material_library_pattern.test(n))t.materialLibraries.push(n.substring(7).trim());else{if(null===(o=this.regexp.smoothing_pattern.exec(n))){if(\"\\0\"===n)continue;throw new Error(\"Unexpected line: '\"+n+\"'\")}var E=o[1].trim().toLowerCase();t.object.smooth=\"1\"===E||\"on\"===E,(U=t.object.currentMaterial())&&(U.smooth=t.object.smooth)}t.finalize();var w=new THREE.Group;w.materialLibraries=[].concat(t.materialLibraries);for(l=0,h=t.objects.length;l<h;l++){var y=t.objects[l],b=y.geometry,O=y.materials,g=\"Line\"===b.type;if(0!==b.vertices.length){var M=new THREE.BufferGeometry;M.addAttribute(\"position\",new THREE.BufferAttribute(new Float32Array(b.vertices),3)),b.normals.length>0?M.addAttribute(\"normal\",new THREE.BufferAttribute(new Float32Array(b.normals),3)):M.computeVertexNormals(),b.uvs.length>0&&M.addAttribute(\"uv\",new THREE.BufferAttribute(new Float32Array(b.uvs),2));for(var _,T=[],x=0,C=O.length;x<C;x++){var D=O[x],U=void 0;if(null!==this.materials&&(U=this.materials.create(D.name),g&&U&&!(U instanceof THREE.LineBasicMaterial))){var R=new THREE.LineBasicMaterial;R.copy(U),R.lights=!1,U=R}U||((U=g?new THREE.LineBasicMaterial:new THREE.MeshPhongMaterial).name=D.name),U.flatShading=D.smooth?THREE.SmoothShading:THREE.FlatShading,T.push(U)}if(T.length>1){for(x=0,C=O.length;x<C;x++){D=O[x];M.addGroup(D.groupStart,D.groupCount,x)}var L=new THREE.MultiMaterial(T);_=g?new THREE.LineSegments(M,L):new THREE.Mesh(M,L)}else _=g?new THREE.LineSegments(M,T[0]):new THREE.Mesh(M,T[0]);_.name=y.name,w.add(_)}}return w}},e.exports=r},function(e,t,r){\"use strict\";r.r(t),function(e){!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/possibleConstructorReturn'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/getPrototypeOf'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/inherits'\");throw e.code=\"MODULE_NOT_FOUND\",e}();var t=r(2),n=r(7),i=(r(3),function(e){function r(e){var t;return function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,r),(t=!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/possibleConstructorReturn'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/getPrototypeOf'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(r).call(this)))._layerid=0,t.zIndex=1e3,t.status=\"running\",t.type=\"gps\",t.clock=new THREE.Clock,t.clock.start(),t.initMap(e),t.initWorld(),t.map.hasGround&&t.addGround(),t.update(),t}return function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/inherits'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(r,e),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(r,[{key:\"initWorld\",value:function(){this.renderer=new THREE.WebGLRenderer(Object.assign({alpha:!0,antialias:!0},this.map.rendererOptions)),this.renderer.setSize(this.map.width,this.map.height),this.map.container.appendChild(this.renderer.domElement),this.renderer.domElement.style.position=\"relative\",this.renderer.domElement.style[\"pointer-events\"]=\"none\",this.renderer.domElement.style[\"z-index\"]=++this.zIndex;this.scene=new THREE.Scene(Object.assign({},this.map.sceneOptions||{})),this.camera=new THREE.PerspectiveCamera(28,this.map.width/this.map.height,1e-6,5e9),this.layers=[],this.world=new THREE.Group,this.scene.add(this.world),this.cameraControl=new n(this)}},{key:\"initMap\",value:function(e){e.transform?(this.map=e,this.map.MAP_TYPE=\"mapbox\",this.map.width=this.map.transform.width,this.map.height=this.map.transform.height,this.map.container=this.map._container,this.map.on(\"resize\",(function(){_this.renderer.setSize(_this.map.width,_this.map.height)}))):e.poiOnAMAP?(this.map=e,this.map.MAP_TYPE=\"amap\",this.map.container=this.map.getContainer(),this.map.width=this.map.container.clientWidth,this.map.height=this.map.container.clientHeight,this.map.on(\"resize\",(function(){_this.renderer.setSize(_this.map.width,_this.map.height)}))):(this.map=Object.assign({rotation:0,width:1e3,height:600,pitch:45,zoom:21,center:[0,0]},e),this.map.MAP_TYPE=\"none\")}},{key:\"update\",value:function(e){e=this.clock.getDelta();for(var t in this.layers)this.layers[t].update&&this.layers[t].update(e);this.renderer.render(this.scene,this.camera);var r,n=this;(r=this.renderer.vr.getDevice())?r.requestAnimationFrame((function(t){\"stop\"!=n.status&&n.update(e)})):requestAnimationFrame((function(t){\"stop\"!=n.status&&n.update(e)}))}},{key:\"addLayer\",value:function(e){e.id=++this._layerid,this.layers.push(e),e.onAdd(this)}},{key:\"removeLayer\",value:function(e){for(var t in this.layers)if(this.layers[t].id==e.id)return this.layers[t].onRemove(),void this.layers.splice(t,1)}},{key:\"setProjectType\",value:function(e){this.type=e,this.cameraControl.type=e}},{key:\"projectToWorld\",value:function(e){if(\"utm\"==this.type)return this.projectUTMToWorld(e);var r=[-t.MERCATOR_A*e[0]*t.DEG2RAD*t.PROJECTION_WORLD_SIZE,-t.MERCATOR_A*Math.log(Math.tan(.25*Math.PI+.5*e[1]*t.DEG2RAD))*t.PROJECTION_WORLD_SIZE],n=this.projectedUnitsPerMeter(e[1]),i=e[2]||0;return r.push(i*n),new THREE.Vector3(r[0],r[1],r[2])}},{key:\"projectUTMToWorld\",value:function(e){return e}},{key:\"projectedUnitsPerMeter\",value:function(e){return Math.abs(t.WORLD_SIZE*(1/Math.cos(e*Math.PI/180))/t.EARTH_CIRCUMFERENCE)}},{key:\"_scaleVerticesToMeters\",value:function(e,t){for(var r=this.projectedUnitsPerMeter(e[1]),n=(this.projectToWorld(e),0);n<t.length;n++)t[n].multiplyScalar(r);return t}},{key:\"projectToScreen\",value:function(e){var t=Object.assign({},e);t[1]=-t[1];var r=this.projectToWorld(t),n=this.world.getWorldPosition().clone().add(r).project(this.camera),i=(this.map.transform.scale,this.map.width/2),a=this.map.height/2;return{x:Math.round(n.x*i+i),y:this.map.height-Math.round(n.y*a+a)}}},{key:\"unprojectFromScreen\",value:function(e){var t=this.map.width/2,r=this.map.height/2,n=-(e.x-t)/t,i=(this.map.height-e.y-r)/r,a=(this.map.transform.scale,new THREE.Vector3(n,i,0).unproject(this.camera)),o=this.world.getWorldPosition().clone(),s=this.unprojectFromWorld(a.sub(o));return s[1]=-s[1],s}},{key:\"unprojectFromWorld\",value:function(e){var r=[-e.x/(t.MERCATOR_A*t.DEG2RAD*t.PROJECTION_WORLD_SIZE),2*(Math.atan(Math.exp(e.y/(t.PROJECTION_WORLD_SIZE*-t.MERCATOR_A)))-Math.PI/4)/t.DEG2RAD],n=this.projectedUnitsPerMeter(r[1]),i=e.z||0;return r.push(i/n),r}},{key:\"_flipMaterialSides\",value:function(e){}},{key:\"addAtCoordinate\",value:function(e,t,r){var n=new THREE.Group;return n.userData.isGeoGroup=!0,n.add(e),this._flipMaterialSides(e),this.world.add(n),this.moveToCoordinate(e,t,r),e}},{key:\"moveToCoordinate\",value:function(e,t,r){void 0===r&&(r={}),void 0===r.preScale&&(r.preScale=1),(void 0===r.scaleToLatitude||e.userData.scaleToLatitude)&&(r.scaleToLatitude=!0),e.userData.scaleToLatitude=r.scaleToLatitude,\"number\"==typeof r.preScale?r.preScale=new THREE.Vector3(r.preScale,r.preScale,r.preScale):r.preScale.constructor===Array&&3===r.preScale.length?r.preScale=new THREE.Vector3(r.preScale[0],r.preScale[1],r.preScale[2]):r.preScale.constructor!==THREE.Vector3&&(console.warn(\"Invalid preScale value: number, Array with length 3, or THREE.Vector3 expected. Defaulting to [1,1,1]\"),r.preScale=new THREE.Vector3(1,1,1));var n,i=r.preScale;if(e.userData.isGeoGroup)n=e;else{if(!e.parent||!e.parent.userData.isGeoGroup)return console.error(\"Cannot set geographic coordinates of object that does not have an associated GeoGroup. Object must be added to scene with 'addAtCoordinate()'.\");n=e.parent}if(r.scaleToLatitude){var a=this.projectedUnitsPerMeter(t[1]);i.multiplyScalar(a)}return n.scale.copy(i),n.position.copy(this.projectToWorld(t)),e.coordinates=t,e}},{key:\"addGeoreferencedMesh\",value:function(e,t){}},{key:\"addGround\",value:function(){var e=new THREE.PlaneGeometry(t.WORLD_SIZE,t.WORLD_SIZE),r=new THREE.MeshPhongMaterial({color:this.map.groundColor||6710886,shininess:30}),n=new THREE.Mesh(e,r);n.position.z=-.01,this.addAtCoordinate(n,this.map.center,{scaleToLatitude:!0,preScale:100})}},{key:\"getDataLayer\",value:function(e){for(var t=0;t<this.layers.length;t++)if(this.layer.id===e)return layer}},{key:\"remove\",value:function(e){this.world.remove(e)}},{key:\"setupDefaultLights\",value:function(){this.scene.add(new THREE.AmbientLight(13421772));var e=new THREE.DirectionalLight(16777215,.5);e.position.set(0,800,1e3),e.matrixWorldNeedsUpdate=!0,this.world.add(e)}}]),r}(r(0)));e.exports=exports=i}.call(this,r(1)(e))},function(e,t,r){var n=r(3),i=r(2);function a(e){this.scope=e,this.map=e.map,this.camera=e.camera,this.active=!0,this.camera.matrixAutoUpdate=!1,this.world=e.world||new THREE.Group,this.world.position.x=this.world.position.y=i.WORLD_SIZE/2,this.world.matrixAutoUpdate=!1;this.listenMapChange()}a.prototype={updateMap:function(e){this.map=Object.assign(this.map,e);\"mapbox\"==this.map.MAP_TYPE?this.updateCamera():\"amap\"==this.map.MAP_TYPE?(this.syncAmap(),this.updateAmapCamera()):\"none\"==this.map.MAP_TYPE&&(this.initMapTransform(),this.updateCamera())},listenMapChange:function(){var e=this;if(this.updateMap(this.map),\"mapbox\"==this.map.MAP_TYPE)this.map.on(\"move\",(function(){e.updateCamera()}));else if(\"amap\"==this.map.MAP_TYPE){this.map.getContainer().addEventListener(\"mousemove\",(function(){e.updateMap()}))}else this.map.MAP_TYPE},syncAmap:function(){var e={},t=(this.map,this.map.getContainer()),r=this.map.getCenter(),n=this.map.getZoom(),i=this.map.getPitch(),a=this.map.getRotation();e.width=t.clientWidth,e.height=t.clientHeight,e.x=this.lngX(r.L,n),e.y=this.latY(r.N,n),e.scale=this.getScale(n),e._pitch=i*Math.PI/180||0,e.angle=a*Math.PI/180||0,this.map.transform=e,this.map.fov=Math.PI/20},initMapTransform:function(){var e={};this.map;e.width=this.map.width,e.height=this.map.height,e.x=this.lngX(this.map.center[0],this.map.zoom),e.y=this.latY(this.map.center[1],this.map.zoom),e.scale=this.getScale(this.map.zoom),e._pitch=this.map.pitch*Math.PI/180||0,e.angle=this.map.rotation*Math.PI/180||0,this.map.transform=e},lngX:function(e,t){return(180+e)*this.getWorldSize(t)/360},latY:function(e,t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))*this.getWorldSize(t)/360},getWorldSize:function(e){return i.WORLD_SIZE*this.getScale(e)},getScale:function(e){return Math.pow(2,e-i.WORLD_SIZE_RATIO||1)},setCenter:function(e){\"mapbox\"==this.map.MAP_TYPE?this.map.setCenter(e):\"amap\"==this.map.MAP_TYPE?this.map.setCenter(e):\"none\"==this.map.MAP_TYPE&&(this.map.center=e,this.initMapTransform())},setRotation:function(e){this.map.rotation=e,\"mapbox\"==this.map.MAP_TYPE?this.map.setRotation(center):\"amap\"==this.map.MAP_TYPE?this.map.setRotation(center):\"none\"==this.map.MAP_TYPE&&(this.map.transform.angle=this.map.rotation*Math.PI/180)},setPitch:function(e){this.map.pitch=e,this.map.rotation=e,\"mapbox\"==this.map.MAP_TYPE?this.map.setPitch(e):\"amap\"==this.map.MAP_TYPE?this.map.setPitch(e):\"none\"==this.map.MAP_TYPE&&(this.map.transform._pitch=this.map.pitch*Math.PI/180)},updateCamera:function(e){if(this.camera){var t=this.map.fov||.6435011087932844,r=.5/Math.tan(t/2)*this.map.transform.height,a=t/2,o=Math.PI/2+this.map.transform._pitch,s=Math.sin(a)*r/Math.sin(Math.PI-o-a),l=1.01*(Math.cos(Math.PI/2-this.map.transform._pitch)*s+r);this.camera.far=l,this.camera.fov=t,this.camera.position.z=r,this.camera.rotation.z=this.map.transform.angle,this.camera.rotation.x=this.map.transform._pitch,this.camera.projectionMatrix=n.makePerspectiveMatrix(t,this.map.transform.width/this.map.transform.height,1,l);var h=new THREE.Matrix4,c=(new THREE.Matrix4).makeTranslation(0,0,r),u=(new THREE.Matrix4).makeRotationX(this.map.transform._pitch),p=(new THREE.Matrix4).makeRotationZ(this.map.transform.angle);h.premultiply(c).premultiply(u).premultiply(p),this.camera.matrixWorld.copy(h);var d=this.map.transform.scale,m=new THREE.Matrix4,f=new THREE.Matrix4,v=new THREE.Matrix4,E=new THREE.Matrix4;m.makeScale(d,d,d),f.makeTranslation(i.WORLD_SIZE/2,-i.WORLD_SIZE/2,0),v.makeTranslation(-this.map.transform.x,this.map.transform.y,0),E.makeRotationZ(Math.PI),this.world.matrix=new THREE.Matrix4;(new THREE.Matrix4).makeTranslation(0,0,-r);this.world.matrix.premultiply(E).premultiply(f).premultiply(m).premultiply(v),n.prettyPrintMatrix(this.camera.projectionMatrix.elements)}else console.log(\"nocamera\")},updateAmapCamera:function(e){var t=this.map.fov||.6435011087932844,r=.5/Math.tan(t/2)*this.map.transform.height,a=t/2,o=Math.PI/2+this.map.transform._pitch,s=Math.sin(a)*r/Math.sin(Math.PI-o-a),l=1.01*(Math.cos(Math.PI/2-this.map.transform._pitch)*s+r);this.camera.projectionMatrix=n.makePerspectiveMatrix(t,this.map.transform.width/this.map.transform.height,1,l);var h=new THREE.Matrix4,c=(new THREE.Matrix4).makeTranslation(0,0,r),u=(new THREE.Matrix4).makeRotationX(this.map.transform._pitch),p=(new THREE.Matrix4).makeRotationZ(this.map.transform.angle);this.camera.position.z=c,h.premultiply(c).premultiply(u).premultiply(p),this.camera.matrixWorld.copy(h);var d=this.map.transform.scale,m=new THREE.Matrix4,f=new THREE.Matrix4,v=new THREE.Matrix4,E=new THREE.Matrix4;m.makeScale(d,d,d),f.makeTranslation(i.WORLD_SIZE/2,-i.WORLD_SIZE/2,0),v.makeTranslation(-this.map.transform.x,this.map.transform.y,0),E.makeRotationZ(Math.PI),this.world.matrix=new THREE.Matrix4,this.world.matrix.premultiply(E).premultiply(f).premultiply(m).premultiply(v)}},e.exports=a},function(e,t,r){var n={MTLLoader:r(4),OBJLoader:r(5),Map:r(6),UTMMap:r(9),Layer:r(0),CameraControl:r(7),SymbolLayer3D:r(11),ThirdPersonView:r(13),MapControl:r(14),TextLayer:r(15),VRLayer:r(16),CloudPoints:r(17)};window.PigeonGL=n},function(e,t,r){\"use strict\";r.r(t),function(e){!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/possibleConstructorReturn'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/getPrototypeOf'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/inherits'\");throw e.code=\"MODULE_NOT_FOUND\",e}();var t=r(6),n=r(10),i=function(e){function t(){var e,r;!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(r=!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/possibleConstructorReturn'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,(e=!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/getPrototypeOf'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t)).call.apply(e,[this].concat(i)))).isUTM=!0,r}return function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/inherits'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t,e),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t,[{key:\"initWorld\",value:function(){this.renderer=new THREE.WebGLRenderer(Object.assign({alpha:!0,antialias:!0},this.map.rendererOptions)),this.renderer.setSize(this.map.width,this.map.height),this.map.container.appendChild(this.renderer.domElement),this.renderer.domElement.style.position=\"relative\",this.renderer.domElement.style[\"pointer-events\"]=\"none\",this.renderer.domElement.style[\"z-index\"]=++this.zIndex;this.scene=new THREE.Scene(Object.assign({},this.map.sceneOptions||{})),this.camera=new THREE.PerspectiveCamera(45,this.map.width/this.map.height,1e-6,5e9),this.layers=[],this.world=new THREE.Group,this.scene.add(this.world),this.camera.position.z=10,this.camera.position.x=this.map.center[0],this.camera.position.y=this.map.center[1],this.cameraControl=new n(this)}},{key:\"updateMap\",value:function(){}},{key:\"moveToCoordinate\",value:function(e,t,r){void 0===r&&(r={}),void 0===r.preScale&&(r.preScale=1),(void 0===r.scaleToLatitude||e.userData.scaleToLatitude)&&(r.scaleToLatitude=!0),e.userData.scaleToLatitude=r.scaleToLatitude,\"number\"==typeof r.preScale?r.preScale=new THREE.Vector3(r.preScale,r.preScale,r.preScale):r.preScale.constructor===Array&&3===r.preScale.length?r.preScale=new THREE.Vector3(r.preScale[0],r.preScale[1],r.preScale[2]):r.preScale.constructor!==THREE.Vector3&&(console.warn(\"Invalid preScale value: number, Array with length 3, or THREE.Vector3 expected. Defaulting to [1,1,1]\"),r.preScale=new THREE.Vector3(1,1,1));var n,i=r.preScale;if(e.userData.isGeoGroup)n=e;else{if(!e.parent||!e.parent.userData.isGeoGroup)return console.error(\"Cannot set geographic coordinates of object that does not have an associated GeoGroup. Object must be added to scene with 'addAtCoordinate()'.\");n=e.parent}return n.scale.copy(i),n.position.copy(this.projectToWorld(t)),e.coordinates=t,e}},{key:\"update\",value:function(){var e=this.clock.getDelta();for(var t in this.layers)this.layers[t].update&&this.layers[t].update(e);this.renderer.render(this.scene,this.camera);var r,n=this;(r=this.renderer.vr.getDevice())?this.animationframe=r.requestAnimationFrame((function(t){\"stop\"!=n.status&&n.update(e)})):this.animationframe=requestAnimationFrame((function(t){\"stop\"!=n.status&&n.update(e)}))}},{key:\"projectToWorld\",value:function(e){return{x:e[0],y:e[1],z:e[2]||0}}},{key:\"unprojectFromWorld\",value:function(e){return[e.x,e.y,e.z]}},{key:\"projectedUnitsPerMeter\",value:function(){return 1}}]),t}(t);e.exports=i}.call(this,r(1)(e))},function(e,t,r){var n=r(2),i=r(3);function a(e){this.scope=e,this.map=e.map,this.camera=e.camera,this.active=!0,this.world=e.world||new THREE.Group,this.world.position.x=this.world.position.y=0,this.camera.matrixAutoUpdate=!1;this.listenMapChange()}a.prototype={updateMap:function(e){this.map=Object.assign(this.map,e);this.initMapTransform(),this.updateCamera()},listenMapChange:function(){this.updateMap(this.map)},initMapTransform:function(){var e={};this.map;e.width=this.map.width,e.height=this.map.height,e.zHeight=this.map.zHeight||0,e.x=this.map.center[0],e.y=this.map.center[1],e.scale=this.getScale(this.map.zoom),e.z=this.map.center[2]||this.getZ(e.scale),e._pitch=this.map.pitch*Math.PI/180||0,e.angle=this.map.rotation*Math.PI/180||0,this.map.transform=e},getZ:function(e){return n.MERCATOR_A/e},getScale:function(e){return Math.pow(2,e-n.WORLD_SIZE_RATIO||1)},setCenter:function(e){this.map.center=e,this.initMapTransform()},setRotation:function(e){this.map.rotation=e,this.map.transform.angle=this.map.rotation*Math.PI/180},setPitch:function(e){this.map.pitch=e,this.map.transform._pitch=this.map.pitch*Math.PI/180},updateCamera:function(e){var t=Math.abs(this.map.transform.z)+this.map.transform.zHeight,r=this.map.fov||.6435011087932844,n=t,a=r/2,o=Math.PI/2+this.map.transform._pitch,s=Math.sin(a)*n/Math.sin(Math.PI-o-a),l=1.01*(Math.cos(Math.PI/2-this.map.transform._pitch)*s+n);this.camera.projectionMatrix=i.makePerspectiveMatrix(r,this.map.transform.width/this.map.transform.height,1,l);var h=new THREE.Matrix4,c=(new THREE.Matrix4).makeTranslation(0,0,t),u=(new THREE.Matrix4).makeRotationX(this.map.transform._pitch),p=(new THREE.Matrix4).makeRotationZ(this.map.transform.angle);h.premultiply(c).premultiply(u).premultiply(p),this.camera.matrixWorld.copy(h),this.world.position.x=-this.map.transform.x,this.world.position.y=-this.map.transform.y}},e.exports=a},function(e,t,r){\"use strict\";r.r(t),function(e){!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/typeof'\");throw e.code=\"MODULE_NOT_FOUND\",e}();r(2),r(3);var t=r(12),n=r(5),i=r(4);function a(e,r){var n=this;if(void 0===r)return console.error(\"Invalid options provided to SymbolLayer3D\");(void 0===r.scale&&(r.scale=1),void 0===r.rotation&&(r.rotation=0),void 0===r.scaleWithMapProjection&&(r.scaleWithMapProjection=!0),(void 0===r.key||\"\"===r.key||\"object\"===!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/typeof'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(r.key)&&void 0===r.key.property&&void 0===r.key.generator)&&(r.key={generator:function(e,t){return t}},console.warn(\"Using array index for SymbolLayer3D key property.\")),this.parent=e,this.id=r.id,this.keyGen=t(r.key),\"string\"==typeof r.source?this.sourcePath=r.source:this.source=r.source,this.modelDirectoryGen=t(r.modelDirectory),this.modelNameGen=t(r.modelName),this.rotationGen=t(r.rotation),this.scaleGen=t(r.scale),this.models=Object.create(null),this.features=Object.create(null),this.scaleWithMapProjection=r.scaleWithMapProjection,this.loaded=!1,this.sourcePath)?(new THREE.FileLoader).load(this.sourcePath,(function(e){n.source=JSON.parse(e),n._initialize()}),(function(){return null}),(function(e){return console.error(\"Could not load SymbolLayer3D source file.\")})):this._initialize()}a.prototype={updateSourceData:function(e,t){var r=this,n={};if(!e.features)return console.error(\"updateSourceData expects a GeoJSON FeatureCollection with a 'features' property\");if(e.features.forEach((function(e,t){var i=r.keyGen(e,t);if(i in r.features)r.features[i].geojson=e,n[i]=e;else{var a=r.modelDirectoryGen(e,t),o=r.modelNameGen(e,t);r.features[i]={geojson:e,model:a+o}}})),this._addOrUpdateFeatures(this.features),t)for(key in this.features)!key in n&&this.removeFeature(key);this.source=e},removeFeature:function(e){this.parent.remove(this.features[e].rawObject),delete this.features[e]},_initialize:function(){var e=this,t=[];if(!this.modelNameGen)return console.error(\"Invalid model name definition provided to SymbolLayer3D\");if(!this.modelDirectoryGen)return console.error(\"Invalid model directory definition provided to SymbolLayer3D\");this.source.features.forEach((function(r,n){var i=e.keyGen(r,n);void 0!==e.features[i]&&console.warn(\"Features with duplicate key: \"+i);var a=e.modelDirectoryGen(r,n),o=e.modelNameGen(r,n);e.features[i]={geojson:r,model:a+o},t.push({directory:a,name:o})})),t.forEach((function(t){return e.models[t.directory+t.name]={directory:t.directory,name:t.name,loaded:!1}}));var r=Object.keys(this.models).length;console.log(\"Loading \"+r+\" models\",this.models);var a=function(){var t,a=new n,s=new i;t=m,o=function(n){if(n){for(material in n.preload(),n.materials)n.materials[material].shininess/=50;a.setMaterials(n)}a.setPath(e.models[t].directory),console.log(\"Loading model \",t),a.load(e.models[t].name+\".obj\",(function(n){e.models[t].obj=n,e.models[t].isMesh=n.isMesh,e.models[t].loaded=!0,function(t){console.log(\"Model complete!\",t),0==--r&&(e.loaded=!0,e._addOrUpdateFeatures(e.features))}(t)}),(function(){return null}),(function(e){console.error(\"Could not load SymbolLayer3D model file.\")}))},s.setPath(e.models[m].directory),s.load(e.models[m].name+\".mtl\",o,(function(){return null}),(function(e){console.warn(\"No material file found for SymbolLayer3D model \"+m),o()}))};for(m in this.models){var o;a()}},_addOrUpdateFeatures:function(e){for(key in e){var t,r=e[key],n=r.geojson.geometry.coordinates,i=this.scaleGen(r.geojson),a=this.rotationGen(r.geojson);r.rawObject?(t=r.rawObject,this.parent.moveToCoordinate(t,n,{scaleToLatitude:this.scaleWithMapProjection,preScale:i})):(r.model&&this.models[r.model]&&this.models[r.model].obj&&this.models[r.model].loaded?t=this.models[r.model].obj.clone():(console.warn(\"Model not loaded: \"+r.model),t=new THREE.Group),r.rawObject=t,this.parent.addAtCoordinate(t,n,{scaleToLatitude:this.scaleWithMapProjection,preScale:i})),t.rotation.copy(a)}}},e.exports=exports=a}.call(this,r(1)(e))},function(e,t,r){\"use strict\";r.r(t),function(e){!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/typeof'\");throw e.code=\"MODULE_NOT_FOUND\",e}();e.exports=exports=function(e){return\"object\"===!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/typeof'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(e)&&void 0!==e.property?function(t){return t.properties[e.property]}:\"object\"===!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/typeof'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(e)&&void 0!==e.generator?e.generator:function(){return e}}}.call(this,r(1)(e))},function(e,t,r){\"use strict\";r.r(t),function(e){!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/possibleConstructorReturn'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/getPrototypeOf'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/inherits'\");throw e.code=\"MODULE_NOT_FOUND\",e}();var t=function(e){function t(e){var r;for(var n in function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,t),(r=!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/possibleConstructorReturn'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/getPrototypeOf'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t).call(this,e))).defaultParams={target:null,viewRotation:0,targetRotation:0,autoUpdate:!1,lockRotation:!0},r.defaultParams)void 0===r[n]&&(r[n]=r.defaultParams[n]);return r}return function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/inherits'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t,e),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t,[{key:\"onAdd\",value:function(e){this.pigeonMap=e,this.initCamera()}},{key:\"initCamera\",value:function(){}},{key:\"update\",value:function(){this.autoUpdate&&this.updateCamera()}},{key:\"updateCamera\",value:function(e){if(!this.target)return!1;var t=this.target.coordinates;this.lockRotation&&(e||(e=180*this.target.rotation.z/Math.PI+this.targetRotation+this.viewRotation),this.pigeonMap.cameraControl.setRotation(e)),this.pigeonMap.cameraControl.setCenter(t),this.pigeonMap.cameraControl.updateCamera()}}]),t}(r(0).default);e.exports=t}.call(this,r(1)(e))},function(e,t,r){\"use strict\";r.r(t),function(e){!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/possibleConstructorReturn'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/getPrototypeOf'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/inherits'\");throw e.code=\"MODULE_NOT_FOUND\",e}();var t=function(e){function t(e){var r;for(var n in function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,t),(r=!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/possibleConstructorReturn'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/getPrototypeOf'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t).call(this,e))).defaultParams={moveSpeed:20,pitchSpeed:.1,rotateSpeed:.15},r.defaultParams)void 0===r[n]&&(r[n]=r.defaultParams[n]);return r}return function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/inherits'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t,e),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t,[{key:\"onAdd\",value:function(e){var t=this;this.pigeonMap=e,this.map=this.pigeonMap.map,this.cameraControl=this.pigeonMap.cameraControl,this.initConfig(),this.listenEvents(),this.on(\"change\",(function(){t.pigeonMap.fire(\"change\"),t.cameraControl.updateMap()}))}},{key:\"initConfig\",value:function(){}},{key:\"listenEvents\",value:function(){var e=this;this.map.container;this.onDown=function(t){0==t.button?e.mouseStatus=\"left\":2==t.button&&(e.mouseStatus=\"right\"),e.mouseDownPosition={x:t.clientX,y:t.clientY},e.map.container.addEventListener(\"mousemove\",e.onMove)},this.onUp=function(t){e.mouseStatus=!1,e.map.container.removeEventListener(\"mousemove\",e.onMove)},this.onMove=function(t){if(e.mouseStatus){if(\"left\"==e.mouseStatus){var r=t.clientY-e.mouseDownPosition.y,n=t.clientX-e.mouseDownPosition.x,i=Math.sqrt(Math.pow(n,2)+Math.pow(r,2));if(i<.1)return!1;var a,o=(n>0?-1:1)*Math.asin(r/i)+e.map.transform.angle;a=e.pigeonMap.isUTM?e.moveSpeed/Math.pow(e.map.zoom,2):e.moveSpeed/e.map.zoom/e.map.transform.scale,e.map.center[0]+=(n>0?-1:1)*(i*Math.cos(o))*a,e.map.center[1]+=(n>0?-1:1)*(i*Math.sin(o))*a,e.cameraControl.updateMap(),e.fire(\"move\",t),e.fire(\"change\",t)}else\"right\"==e.mouseStatus&&(e.map.pitch+=e.pitchSpeed*(t.clientY-e.mouseDownPosition.y),e.map.pitch>90?e.map.pitch=90:e.map.pitch<0&&(e.map.pitch=0),e.map.rotation-=e.rotateSpeed*(t.clientX-e.mouseDownPosition.x),e.cameraControl.updateMap(),e.fire(\"rotate\",t),e.fire(\"change\",t));e.mouseDownPosition={x:t.clientX,y:t.clientY}}},this.onWheel=function(t){e.map.zoom-=t.deltaY/100,e.cameraControl.updateMap(),t.preventDefault(),e.fire(\"zoom\",t),e.fire(\"change\",t)},this.onContextmenu=function(e){e.preventDefault(),e.stopPropagation()},this.map.container.addEventListener(\"mousedown\",this.onDown),this.map.container.addEventListener(\"mouseup\",this.onUp),this.map.container.addEventListener(\"mousemove\",this.onMove),this.map.container.addEventListener(\"wheel\",this.onWheel),this.map.container.addEventListener(\"contextmenu\",this.onContextmenu)}},{key:\"removeListenr\",value:function(){this.map.container.removeEventListener(\"mousedown\",this.onDown),this.map.container.removeEventListener(\"mouseup\",this.onUp),this.map.container.removeEventListener(\"mousemove\",this.onMove),this.map.container.removeEventListener(\"wheel\",this.onWheel),this.map.container.removeEventListener(\"contextmenu\",this.onContextmenu)}}]),t}(r(0).default);e.exports=t}.call(this,r(1)(e))},function(e,t,r){\"use strict\";r.r(t),function(e){!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/possibleConstructorReturn'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/getPrototypeOf'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/inherits'\");throw e.code=\"MODULE_NOT_FOUND\",e}();var t=function(e){function t(e){var r;for(var n in function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,t),(r=!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/possibleConstructorReturn'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/getPrototypeOf'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t).call(this,e))).defaultParams={fontSize:\"14px\",color:\"#000000\",canvasRender:!1},r.texts=[],r.textId=0,r.defaultParams)void 0===r[n]&&(r[n]=r.defaultParams[n]);return r}return function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/inherits'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t,e),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t,[{key:\"onAdd\",value:function(e){this.pigeonMap=e,this.canvasRender?this.initCanvas():this.initDom();var t=this;function r(){t.updateText()}this.change=r,this.pigeonMap.on(\"change\",r)}},{key:\"initDom\",value:function(){this.container=this.pigeonMap.map.container;var e=document.createElement(\"div\");e.id=\"text_layer_\"+this.id,e.className=\"pigeonGL-text-layer\",e.setAttribute(\"width\",this.pigeonMap.map.width),e.setAttribute(\"height\",this.pigeonMap.map.height),e.style.position=\"absolute\",e.style.top=\"0\",e.style.left=\"0\",e.style.zIndex=++this.pigeonMap.zIndex,this.dom=e,this.container.appendChild(e)}},{key:\"initCanvas\",value:function(){this.container=this.pigeonMap.map.container;var e=document.createElement(\"canvas\");e.id=\"text_layer_\"+this.id,this.container.appendChild(e),e.setAttribute(\"width\",this.pigeonMap.map.width),e.setAttribute(\"height\",this.pigeonMap.map.height),e.style.position=\"absolute\",e.style.top=\"0\",e.style.left=\"0\",e.style.zIndex=++this.pigeonMap.zIndex,this.canvas=e}},{key:\"addText\",value:function(e){return(e=Object.assign({},e)).id=e.id||\"_text_\"+this.textId++,this.texts.push(e),e}},{key:\"drawText\",value:function(){this.canvasRender?this.drawCanvasText():this.drawDomText()}},{key:\"drawDomText\",value:function(){for(var e in this.dom.innerHTML=\"\",this.texts){var t=this.pigeonMap.projectToScreen(this.texts[e].lnglat),r=document.createElement(\"span\");for(var n in r.id=this.texts[e].id,r.innerHTML=this.texts[e].text,this.dom.appendChild(r),r.style.position=\"absolute\",r.style.top=t.y+\"px\",r.style.left=t.x+\"px\",this.texts[e].style)r.style[n]=this.texts[e].style[n]}}},{key:\"drawCanvasText\",value:function(){var e=this.canvas.getContext(\"2d\");for(var t in e.clearRect(0,0,this.canvas.width,this.canvas.height),this.texts){var r=this.pigeonMap.projectToScreen(this.texts[t].lnglat);e.font=this.texts[t].font||this.font,e.fillStyle=this.texts[t].color||this.color,e.fillText(this.texts[t].text,r.x,r.y)}}},{key:\"updateDomText\",value:function(){var e=this.dom.querySelectorAll(\"span\");for(var t in this.texts){var r=this.pigeonMap.projectToScreen(this.texts[t].lnglat);e[t].style.top=r.y+\"px\",e[t].style.left=r.x+\"px\"}}},{key:\"removeText\",value:function(e){for(var t in this.texts)if(this.texts[t].id==e)return this.texts.splice(t,1),void this.drawText()}},{key:\"update\",value:function(){}},{key:\"updateText\",value:function(){this.canvasRender?this.drawCanvasText():this.updateDomText()}},{key:\"getText\",value:function(e){for(var t in this.texts)if(this.texts[t].id==e)return this.text[t]}},{key:\"onRemove\",value:function(){this.pigeonMap.off(\"change\",this.change),this._listeners=null}},{key:\"getTextIndex\",value:function(e){for(var t in this.texts)if(this.texts[t].id==e)return t}}]),t}(r(0).default);e.exports=t}.call(this,r(1)(e))},function(e,t,r){\"use strict\";r.r(t),function(e){!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/possibleConstructorReturn'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/getPrototypeOf'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/inherits'\");throw e.code=\"MODULE_NOT_FOUND\",e}();var t=r(0);e.exports=function(e){function t(e){var r;return function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,t),(r=!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/possibleConstructorReturn'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/getPrototypeOf'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t).call(this,e))).noVR=!1,r.vrStatus=\"not suppert VR\",r.listenEvents(),r.getVRDisplays(),r}return function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/inherits'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t,e),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t,[{key:\"getVRDisplays\",value:function(){var e=this;navigator.getVRDisplays&&navigator.getVRDisplays().then((function(t){t.length>0?(e.device=t[0],e.renderer.vr.enabled=!0,e.pigeonMap.renderer.vr.setDevice(e.device),e.frameData=new VRFrameData):(e.vrStatus=\"noDisplay\",console.warn(\"no vr displays\"))})).catch((function(e){console.warn(\"Unable to get VR Displays\")}))}},{key:\"listenEvents\",value:function(){var e=this;window.addEventListener(\"vrdisplayconnect\",(function(t){e.device=t.display||t.detail.display,e.status,e.renderer.vr.enabled=!0,e.fire(\"connected\",e.device)}),!1),window.addEventListener(\"vrdisplaydisconnect\",(function(t){e.status,e.renderer.vr.enabled=!1,e.fire(\"disconnet\",e.device)}),!1),window.addEventListener(\"vrdisplaypresentchange\",(function(t){e.device=t.display||t.detail.display,e.fire(\"statuschange\",e.device)}),!1)}},{key:\"enterVR\",value:function(){this.device.requestPresent([{source:this.renderer.domElement}])}},{key:\"exitVR\",value:function(){this.device.exitPresent()}},{key:\"createButton\",value:function(e){var t=this;e||((e=document.createElement(\"button\")).style.position=\"absolute\",e.style.bottom=\"20px\",e.style.padding=\"12px 6px\",e.style.border=\"1px solid #fff\",e.style.borderRadius=\"4px\",e.style.background=\"transparent\",e.style.color=\"#fff\",e.style.textAlign=\"center\",e.style.opacity=\"0.5\",e.style.outline=\"none\",e.style.zIndex=\"9999\",e.style.cursor=\"auto\",e.style.left=\"calc(50% - 75px)\",e.style.width=\"150px\",e.textContent=\"Enter VR\",document.body.appendChild(e)),e.addEventListener(\"click\",(function(){t.device&&t.enterVR()}))}},{key:\"onAdd\",value:function(e){this.pigeonMap=e,this.renderer=e.renderer,this.initVRRenderer()}},{key:\"initVRRenderer\",value:function(){}}]),t}(t.default)}.call(this,r(1)(e))},function(e,t,r){\"use strict\";r.r(t),function(e){!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/possibleConstructorReturn'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/getPrototypeOf'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/inherits'\");throw e.code=\"MODULE_NOT_FOUND\",e}();var t=function(e){function t(e){var r;return function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/classCallCheck'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,t),(r=!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/possibleConstructorReturn'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(this,!function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/getPrototypeOf'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t).call(this,e))).lanePoints=[],r.initPoints(),r}return function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/inherits'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t,e),function(){var e=new Error(\"Cannot find module '@babel/runtime/helpers/createClass'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(t,[{key:\"initPoints\",value:function(){this.material=new THREE.PointsMaterial({color:16777215,size:10}),this.pointsGeometry=new THREE.BufferGeometry,this.points=new THREE.Points(this.pointsGeometry,this.material)}},{key:\"onAdd\",value:function(e){this.pigeonMap=e,this.pigeonMap.world.add(this.points)}},{key:\"drawPoints\",value:function(e){this.baseLngLat=e[0],this.baseXYZ=this.pigeonMap.projectToWorld(this.baseLngLat);var t,r=[],n=[],i=[];for(var a in e)t=this.pigeonMap.projectToWorld(e[a]),r.push(t.x-this.baseXYZ.x,t.y-this.baseXYZ.y,t.z-this.baseXYZ.z),i.push(e[a]),n.push(a);this.points.geometry.addAttribute(\"position\",new THREE.Float32BufferAttribute(r,3)),this.points.geometry.computeBoundingSphere(),this.points.position.x=this.baseXYZ.x,this.points.position.y=this.baseXYZ.y,this.points.position.z=this.baseXYZ.z}}]),t}(r(0).default);e.exports=t}.call(this,r(1)(e))}]);","extractedComments":[]}