<!doctype html>
<head>
    <title>Basic Example</title>
    <script src="../../build/lib/three.js" type="text/javascript"></script>
    <script src="../../build/pigeonGL.js" type="text/javascript"></script>
    <script src='https://api.mapbox.com/mapbox-gl-js/v0.34.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v0.34.0/mapbox-gl.css' rel='stylesheet' />
   
    <style>
        body, html { 
            width: 100%;
            height: 100%;
            margin: 0;
        }
        #map { 
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <div id='map' class='map'></div>
    <script>
    var config = {
        accessToken: 'pk.eyJ1Ijoic3dheWRlbmciLCJhIjoiY2l0bGFvMnRzMDJ6bDJ0cG5ibnlwZmp6ZiJ9.c-F2NnbfT2tnbPcY0dfc2g'
    };
    var lnglat = [116.333926, 39.997245];
    mapboxgl.accessToken = config.accessToken;
    var mapboxMap = new mapboxgl.Map({
        width:1000,
        height:600,
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v8',
        center: lnglat,
        zoom: 20,
        maxZoom:40,
        pitch:30
    });

    mapboxMap.on("load", function() {
        var map = new PigeonGL.Map(mapboxMap)
        map.setupDefaultLights();
          //卡车
        var mtlLoader = new PigeonGL.MTLLoader();
        mtlLoader.setPath( './models/' );//加载皮肤
        mtlLoader.load( 'Truck.mtl', function( materials ) {
            materials.preload();
            var objLoader =  new PigeonGL.OBJLoader();//加载模型
            objLoader.setMaterials( materials );
            objLoader.load("./models/Truck.obj",function(obj){
                obj.rotation.y = Math.PI/2 ;
                obj.rotation.x = Math.PI/2 ;
                //缩放成每单位代表1米
                var target = map.addAtCoordinate(obj, lnglat, {scaleToLatitude: true, preScale:10})
                
            },function ( xhr ) {
                console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );
            })
        });
    })

   
    </script>
</body>